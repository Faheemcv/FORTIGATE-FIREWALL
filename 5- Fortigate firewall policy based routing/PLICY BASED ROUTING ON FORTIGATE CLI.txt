PLICY BASED ROUTING ON FORTIGATE FIREWALL

FIREWALL
----------
FortiGate-VM64-KVM login: admin
Password:
You are forced to change your password. Please input a new password.
New Password:
Confirm Password:
Welcome!

FortiGate-VM64-KVM # show system interface
name    Name.
fortilink   static   0.0.0.0 0.0.0.0  10.255.1.1 255.255.255.0  up   disable   aggregate  enable
port1   dhcp   0.0.0.0 0.0.0.0  192.168.208.141 255.255.255.0  up   disable   physical  enable
port2   static   0.0.0.0 0.0.0.0  0.0.0.0 0.0.0.0  up   disable   physical  enable
port3   static   0.0.0.0 0.0.0.0  0.0.0.0 0.0.0.0  up   disable   physical  enable
port4   static   0.0.0.0 0.0.0.0  0.0.0.0 0.0.0.0  up   disable   physical  enable
port5   static   0.0.0.0 0.0.0.0  0.0.0.0 0.0.0.0  up   disable   physical  enable
port6   static   0.0.0.0 0.0.0.0  0.0.0.0 0.0.0.0  up   disable   physical  enable
port7   static   0.0.0.0 0.0.0.0  0.0.0.0 0.0.0.0  up   disable   physical  enable
port8   static   0.0.0.0 0.0.0.0  0.0.0.0 0.0.0.0  up   disable   physical  enable
port9   static   0.0.0.0 0.0.0.0  0.0.0.0 0.0.0.0  up   disable   physical  enable
port10   static   0.0.0.0 0.0.0.0  0.0.0.0 0.0.0.0  up   disable   physical  enable
ssl.root   static   0.0.0.0 0.0.0.0  0.0.0.0 0.0.0.0  up   disable   tunnel  enable

FortiGate-VM64-KVM # config system interface

FortiGate-VM64-KVM (interface) # edit port1

FortiGate-VM64-KVM (port1) # set allowaccess http https ping ssh

FortiGate-VM64-KVM (port1) # end

FortiGate-VM64-KVM # Timeout


FortiGate-VM64-KVM login: admin
Password:
Welcome!

FortiGate-VM64-KVM # exit


FortiGate-VM64-KVM login: admin
Password:
Welcome!

FortiGate-VM64-KVM # exit


FortiGate-VM64-KVM login: admin
Password:
Welcome!

FortiGate-VM64-KVM # ex
Unknown action 0

FortiGate-VM64-KVM # exit


FortiGate-VM64-KVM login: admin
Password:
Welcome!

FortiGate-VM64-KVM # Timeout


FortiGate-VM64-KVM login: admin
Password:
Welcome!

FortiGate-VM64-KVM # Timeout

--------------------------------------------------------------------------------------------------------------------------------------------


ROUTER 1
---------
R1#conf t
Enter configuration commands, one per line.  End with CNTL/Z.
R1(config)#int f0/0
R1(config-if)#ip add 192.168.1.1 255.255.255.0
R1(config-if)#no sh
R1(config-if)#ex
*Aug 19 12:49:24.227: %LINK-3-UPDOWN: Interface FastEthernet0/0, changed state to up
*Aug 19 12:49:25.227: %LINEPROTO-5-UPDOWN: Line protocol on Interface FastEthernet0/0, changed state to up
R1(config-if)#ex
R1(config)#
R1(config)#
R1(config)#ip route 0.0.0.0 0.0.0.0 192.168.1.100
R1(config)#
R1(config)#do sh ip route
Codes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP
       D - EIGRP, EX - EIGRP external, O - OSPF, IA - OSPF inter area
       N1 - OSPF NSSA external type 1, N2 - OSPF NSSA external type 2
       E1 - OSPF external type 1, E2 - OSPF external type 2
       i - IS-IS, su - IS-IS summary, L1 - IS-IS level-1, L2 - IS-IS level-2
       ia - IS-IS inter area, * - candidate default, U - per-user static route
       o - ODR, P - periodic downloaded static route, H - NHRP, l - LISP
       a - application route
       + - replicated route, % - next hop override

Gateway of last resort is 192.168.1.100 to network 0.0.0.0

S*    0.0.0.0/0 [1/0] via 192.168.1.100
      192.168.1.0/24 is variably subnetted, 2 subnets, 2 masks
C        192.168.1.0/24 is directly connected, FastEthernet0/0
L        192.168.1.1/32 is directly connected, FastEthernet0/0
R1(config)#
R1(config)#
R1(config)#do tra
R1(config)#do traceroute 192.168.3.1
Type escape sequence to abort.
Tracing the route to 192.168.3.1
VRF info: (vrf in name/id, vrf out name/id)
  1 192.168.1.100 40 msec 32 msec 16 msec
  2 192.168.2.1 60 msec 20 msec 28 msec
R1(config)#
R1(config)#
R1(config)#

R1(config)#ex
% Ambiguous command:  "ex"
R1(config)#exit
R1#c
*Aug 19 13:10:25.183: %SYS-5-CONFIG_I: Configured from console by console
R1#conf t
Enter configuration commands, one per line.  End with CNTL/Z.


Password:
R3>
R3>
R3>
R3>

R1(config)#do ping 192.168.3.1
Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 192.168.3.1, timeout is 2 seconds:
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 88/108/176 ms
R1(config)#do ping 192.168.3.1
Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 192.168.3.1, timeout is 2 seconds:
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 20/28/32 ms
R1(config)#



--------------------------------------------------------------------------------------------------------------------------------------------

ROUTER 2
----------
R2#conf t
Enter configuration commands, one per line.  End with CNTL/Z.
R2(config)#int f0/0
R2(config-if)#ip add 192.168.2.1 255.255.255.0
R2(config-if)#no sh
R2(config-if)#ex
R2(config)#
*Aug 19 12:53:57.075: %LINK-3-UPDOWN: Interface FastEthernet0/0, changed state to up
*Aug 19 12:53:58.075: %LINEPROTO-5-UPDOWN: Line protocol on Interface FastEthernet0/0, changed state to up
R2(config)#
R2(config)#
R2(config)#
R2(config)#int loopback 0
R2(config-if)#
*Aug 19 12:54:22.767: %LINEPROTO-5-UPDOWN: Line protocol on Interface Loopback0, changed state to up
R2(config-if)#ip add 192.168.3.1 255.255.255.0
R2(config-if)#ex
R2(config)#
R2(config)#
R2(config)#ip route 0.0.0.0 0.0.0.0 192.168.2.100
R2(config)#
R2(config)#
R2(config)#
R2(config)#do sh ip route
Codes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP
       D - EIGRP, EX - EIGRP external, O - OSPF, IA - OSPF inter area
       N1 - OSPF NSSA external type 1, N2 - OSPF NSSA external type 2
       E1 - OSPF external type 1, E2 - OSPF external type 2
       i - IS-IS, su - IS-IS summary, L1 - IS-IS level-1, L2 - IS-IS level-2
       ia - IS-IS inter area, * - candidate default, U - per-user static route
       o - ODR, P - periodic downloaded static route, H - NHRP, l - LISP
       a - application route
       + - replicated route, % - next hop override

Gateway of last resort is 192.168.2.100 to network 0.0.0.0

S*    0.0.0.0/0 [1/0] via 192.168.2.100
      192.168.2.0/24 is variably subnetted, 2 subnets, 2 masks
C        192.168.2.0/24 is directly connected, FastEthernet0/0
L        192.168.2.1/32 is directly connected, FastEthernet0/0
      192.168.3.0/24 is variably subnetted, 2 subnets, 2 masks
C        192.168.3.0/24 is directly connected, Loopback0
L        192.168.3.1/32 is directly connected, Loopback0
R2(config)#
R2(config)#
R2(config)#
R2(config)#
R2(config)#link vty 0 4
              ^
% Invalid input detected at '^' marker.

R2(config)#line vty 0 4
R2(config-line)#password 123
R2(config-line)#login
R2(config-line)#exit
R2(config)#enable password 123
R2(config)#

R2(config)#do ping 192.168.3.1
Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 192.168.3.1, timeout is 2 seconds:
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 4/6/8 ms
R2(config)#do ping 192.168.3.1
Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 192.168.3.1, timeout is 2 seconds:
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 4/5/8 ms
R2(config)#



--------------------------------------------------------------------------------------------------------------------------------------------

ROUTER 3
-----------

R3#conf t
Enter configuration commands, one per line.  End with CNTL/Z.
R3(config)#
R3(config)#int f0/0
R3(config-if)#ip add 192.168.2.2 255.255.255.0
R3(config-if)#no sh
R3(config-if)#ex
R3(config)#
*Aug 19 12:55:58.519: %LINK-3-UPDOWN: Interface FastEthernet0/0, changed state to up
*Aug 19 12:55:59.519: %LINEPROTO-5-UPDOWN: Line protocol on Interface FastEthernet0/0, changed state to up
R3(config)#int loopba
R3(config)#int loopback 0
R3(config-if)#
*Aug 19 12:56:07.587: %LINEPROTO-5-UPDOWN: Line protocol on Interface Loopback0, changed state to up
R3(config-if)#ip add 192.168.3.1 255.255.255.0
R3(config-if)#ex
R3(config)#ip route 192
% Incomplete command.

R3(config)#ip route 0.0.0.0. 0.0.0.0 192.168.2.100
                           ^
% Invalid input detected at '^' marker.

R3(config)#ip route 0.0.0.0 0.0.0.0 192.168.2.100
R3(config)#
R3(config)#
R3(config)#
R3(config)#do sh ip route
Codes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP
       D - EIGRP, EX - EIGRP external, O - OSPF, IA - OSPF inter area
       N1 - OSPF NSSA external type 1, N2 - OSPF NSSA external type 2
       E1 - OSPF external type 1, E2 - OSPF external type 2
       i - IS-IS, su - IS-IS summary, L1 - IS-IS level-1, L2 - IS-IS level-2
       ia - IS-IS inter area, * - candidate default, U - per-user static route
       o - ODR, P - periodic downloaded static route, H - NHRP, l - LISP
       a - application route
       + - replicated route, % - next hop override

Gateway of last resort is 192.168.2.100 to network 0.0.0.0

S*    0.0.0.0/0 [1/0] via 192.168.2.100
      192.168.2.0/24 is variably subnetted, 2 subnets, 2 masks
C        192.168.2.0/24 is directly connected, FastEthernet0/0
L        192.168.2.2/32 is directly connected, FastEthernet0/0
      192.168.3.0/24 is variably subnetted, 2 subnets, 2 masks
C        192.168.3.0/24 is directly connected, Loopback0
L        192.168.3.1/32 is directly connected, Loopback0
R3(config)#
R3(config)#
R3(config)#traceroute 192.168.3.1
               ^
% Invalid input detected at '^' marker.

R3(config)#tra
R3(config)#trace
R3(config)#tracer
R3(config)#tracerou
R3(config)#traceroute
R3(config)#traceroute 192.168.3.1
               ^
% Invalid input detected at '^' marker.

R3(config)#do tr
R3(config)#do traceroute 192.168.3.1
Type escape sequence to abort.
Tracing the route to 192.168.3.1
VRF info: (vrf in name/id, vrf out name/id)
  1 192.168.3.1 8 msec 8 msec 4 msec
R3(config)#
R3(config)#
R3(config)#
R3(config)#lin
R3(config)#line vt
R3(config)#line vty 0 4
R3(config-line)#password 123
R3(config-line)#login
R3(config-line)#exit
R3(config)#enable
R3(config)#enable pas
R3(config)#enable password 123
R3(config)#

R3(config)#do ping 192.168.1.1
Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 192.168.1.1, timeout is 2 seconds:
.....
Success rate is 0 percent (0/5)
R3(config)#
R3(config)#do ping 192.168.3.1
Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 192.168.3.1, timeout is 2 seconds:
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 4/7/8 ms
R3(config)#do ping 192.168.3.1
Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 192.168.3.1, timeout is 2 seconds:
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 1/3/8 ms
R3(config)#

____________________________________________________________________________________________________________________________________________